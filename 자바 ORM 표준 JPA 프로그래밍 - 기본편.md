자바 ORM 표준 JPA 프로그래밍 - 기본편

## JPA소개
### SQL 중심적인 개발의 문제점
#### 객체와 관계형 데이터베이스의 차이
1. 상속
2. 연관관계
3. 데이터 타입
4. 데이터 식별 방법
객체답게 모델링 할수록 매핑 작업만 늘어난다.
객체를 자바 컬렉션에 저장 하듯이 DB에 저장할 수는 없을까?

**답은 JPA-Java Persistence API**

### JPA 소개
#### JPA?
- Java Persistence API
- 자바 진영의 ORM 기술 표준
#### ORM?
- Object-relational mapping(객체 관계 매핑)
- 객체는 객체대로 설계
- 관계형 데이터베이스는 관계형 데이터베이스대로 설계
- ORM 프레임워크가 중간에서 매핑
- 대중적인 언어에는 대부분 ORM기술이 존재

#### JPA는 어플리케이션과 JDBC 사이에서 동작한다.
- JPA가 JDBC API에 맞게 SQL 쿼리를 다 짜서 넘긴다.

#### JPA를 왜 사용해야 하는가?
##### SQL중심적인 개발에서 객체 중심으로 개발
##### 생산성-JPA와 CRUD
- 저장: jpa.persist(member)
- 조회: Member member = jpa.find(memberId)
- 수정: member.setName("변경할 이름")
- 삭제: jpa.remove(member)
##### 유지보수
- 기존: 필드 변경시 모든 SQL 수정
- JPA: 필드만 추가하면됨, SQL은 JPA가 처리
##### 패러다임의 불일치 해결
1. JPA와 상속
- 개발자가 할일이 현저히 줄어든다. 나머지는 JPA가 해주기 때문
2. JPA와 연관관계
3. JPA와 객체 그래프 탐색
4. JPA와 비교하기
##### JPA의 성능 최적화 기능
1. 1차 캐시와 동일성(identity) 보장
	1. 같은 트랙잭션 안에서는 같은 엔티티를 반환 - 약간의 조회 성능 향상
	2. DB Isolation Level이 Read Commit이어도 애플리케이션에서 Repetable Read 보장
2. 트랜잭션을 지원하는 쓰기 지연(transactional write-behid)
3. 지연로딩(Lazy Loading)
	- 지연로딩: 객체가 실제 사용될때 로딩(쿼리가 두번날라간다)
	- 즉시로딩: JOIN SQL로 한번에 연관된 객체까지 미리조회(쿼리가 한번에)
##### 데이터 접근 추상화와 벤터 독립성
##### 표준

**ORM은 객체와 RDB 두 기둥위에 있는 기술이다. 둘중 뭐가 더 중요한지를 굳이 따지자면 RDB가 더 중요하다. 데이터는 더 오래 살아남기때문,, SQL공부를 게을리하지 말자.**

## 영속성 관리
### JPA에서 가장 중요한 2가지
- 객체와 관계형 데이터베이스 매핑하기  (Object Relational Mapping) 
- 영속성 컨텍스트

## 양방향 연관관계와 연관관계주인
### 연관관계의 주인
- 테이블은 외래 키 하나로 두 테이블이 연관관계를 맺음
- 객체 양방향 관계는 A->B, B->A 처럼 참조가 두군데
- 객체 양방향 관계는 참조가 두군데 있음. 둘중 테이블의 외래 키를 관리할 곳을 지정해야함
- 연관관계의 주인: 왜래 키를 관리하는 참조
- 주인의 반대편: 외래 키에 영향을 주지 않음, 단순 조회만 가능
### 양방향 매핑시 가장 많이 하는 실수
- 연관관계의 주인에 값을 입력하지 않음